<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Online OCR - Image to Text Converter</title>
  <link rel="stylesheet" href="/templates/static/css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container header-content">
      <h1>OCRGenius</h1>
  
      <!-- ✅ Desktop Navigation -->
      <nav class="desktop-nav">
<ul>
  <li><a href="/" class="translate" data-key="home">Home</a></li>
  <li><a href="/image-to-word" class="translate" data-key="imageToWord">IMAGE TO WORD</a></li>
  <li><a href="/image-to-excel" class="translate" data-key="imageToExcel">IMAGE TO EXCEL</a></li>
  <li><a href="/pdf-to-image" class="translate" data-key="pdfToImage">PDF TO IMAGE</a></li>
</ul>

        <div class="nav-right">
            <!-- ✅ Language Selector (Moves to mobile menu on small screens) -->
             <div class="language-select">
              <select id="ui-language-select">
                  <option value="en">🇺🇸 English</option>
                  <option value="hi">🇮🇳 Hindi</option>
                  <option value="es">🇪🇸 Spanish</option>
                  <option value="fr">🇫🇷 French</option>
                  <option value="de">🇩🇪 German</option>
              </select>            
          </div>
            <button id="theme-toggle">🌙 Dark Mode</button>
        </div>
    </nav>
  
    <!-- ✅ Mobile Menu Button + Language Selector -->
    <div class="mobile-menu-container">
        <button id="menu-btn" class="menu-btn">☰ Menu</button>
        <div class="language-select mobile-lang"></div> <!-- Language selector moves here -->
    </div>
  </div></header>
  
  <!-- ✅ Modal Navigation Menu -->
  <div id="modal-menu" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <ul>
            <li><a href="/templates/home.html" class="translate" data-key="home">Home</a></li>
            <li><a href="/templates/image_to_word.html" class="translate" data-key="imageToWord">IMAGE TO WORD</a></li>
            <li><a href="/templates/image_to_excel.html" class="translate" data-key="imageToExcel">IMAGE TO EXCEL</a></li>
            <li><a href="/templates/pdf_to_image.html" class="translate" data-key="pdfToImage">PDF TO IMAGE</a></li>       
        </ul>
        
        <div class="modal-actions">
            <button id="modal-theme-toggle">🌙 Dark Mode</button>
        </div>
    </div>
  </div>
  
  <div class="first">
    <h1>📝 Convert Image to Word in Seconds – Free & Accurate OCR Tool</h1>
    <p>Extract text from images and download it as a Word document with just a few clicks</strong>.</p>
  </div>

  <!-- Main Section -->
  <main class="container">
    <section class="ocr-section">
      <h2>Image to Text Converter</h2>
      <p>Upload an image (JPG, PNG) or PDF to extract text.</p>
      <div class="upload-area">
        <input type="file" id="file-input" accept=".jpg,.jpeg,.png,.pdf" hidden>
        <label for="file-input" class="upload-label">
          <i class="fas fa-upload"></i>
          <span>Choose File</span>
        </label>
        <span id="file-name">No file chosen</span>
      </div>
      <div class="language-select">
        <label for="language"><span>Select Language</span></label>
        <div class="custom-dropdown">
          <div class="selected-option" id="selected-option">🇺🇸 English</div>
          <div class="options-box" id="options-box">
            <div class="option" data-value="eng">🇺🇸 English</div>
            <div class="option" data-value="hin">🇮🇳 Hindi</div>
            <div class="option" data-value="spa">🇪🇸 Spanish</div>
            <div class="option" data-value="fra">🇫🇷 French</div>
            <div class="option" data-value="deu">🇩🇪 German</div>
            <div class="option" data-value="chi_sim">🇨🇳 Chinese (Simplified)</div>
            <div class="option" data-value="chi_tra">🇨🇳 Chinese (Traditional)</div>
            <div class="option" data-value="ara">🇸🇦 Arabic</div>
            <div class="option" data-value="por">🇵🇹 Portuguese</div>
            <div class="option" data-value="rus">🇷🇺 Russian</div>
            <div class="option" data-value="jpn">🇯🇵 Japanese</div>
            <div class="option" data-value="ita">🇮🇹 Italian</div>
            <div class="option" data-value="kor">🇰🇷 Korean</div>
            <div class="option" data-value="tur">🇹🇷 Turkish</div>
            <div class="option" data-value="nld">🇳🇱 Dutch</div>
            <div class="option" data-value="pol">🇵🇱 Polish</div>
            <div class="option" data-value="vie">🇻🇳 Vietnamese</div>
            <div class="option" data-value="urd">🇵🇰 Urdu</div>
            <div class="option" data-value="ben">🇧🇩 Bengali</div>
            <div class="option" data-value="tam">🇮🇳 Tamil</div>
            <div class="option" data-value="tel">🇮🇳 Telugu</div>
          </div>
        </div>
      </div>

     <div class="process-container">
  <button id="process-btn">Extract Text</button>
  <!-- Processing Section -->
  <div id="processing-section" class="processing-section">
    <div class="loader"></div>
    <p>Processing... </p>
  
  </div>
</div>
      <div class="output-section">
        <textarea id="output-text" placeholder="Extracted text will appear here..." readonly></textarea>
        <div class="output-actions">
          <button id="copy-btn"><i class="fas fa-copy"></i> Copy</button>
          <button onclick="downloadWordFile()" id="download-word-btn">
            <i class="fas fa-download"></i> <span>Download Word</span>
        </button>
        </div>
      </div>
    </section>
  </main>


  <div class="mera">
    <div class="row">
        <div class="col-md">
            <div class="feature-box">
                <img src="/static/1st.webp" alt="Convert Image to Word">
                <h2>AI-Powered Image to Word</h2>
                <p>Convert images into fully editable Word documents with our AI-driven OCR. Preserve text formatting and layout effortlessly.</p>
            </div>
        </div>
        <div class="col-md">
            <div class="feature-box">
                <img src="/static/2nd.webp" alt="Extract Text from PDFs to Word">
                <h2>Extract Text from Scanned PDFs</h2>
                <p>Convert scanned PDFs into Word documents while retaining structure, tables, and formatting for seamless editing.</p>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md">
            <div class="feature-box">
                <img src="/static/3rd.webp" alt="Secure Word Conversion">
                <h2>Privacy & Security Guaranteed</h2>
                <p>All uploaded files are encrypted and deleted after processing. Registered users can store documents securely.</p>
            </div>
        </div>
        <div class="col-md">
            <div class="feature-box">
                <img src="/static/4th.webp" alt="Access Anywhere">
                <h2>Works on Any Device</h2>
                <p>Convert images to Word on Windows, Mac, Linux, Android, and iOS—no software installation required.</p>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md">
            <div class="feature-box">
                <img src="/static/5th.webp" alt="AI OCR for Word Conversion">
                <h2>AI-Driven OCR for High Accuracy</h2>
                <p>Extract text with 99% accuracy using AI-powered OCR. Supports multiple languages, including handwritten text.</p>
            </div>
        </div>
        <div class="col-md">
            <div class="feature-box">
                <img src="/static/6th.png" alt="Free Image to Word Service">
                <h2>100% Free for Limited Use</h2>
                <p>Process up to <span id="MainContent_TextFreeFiles">5</span> images per hour for free. Upgrade to unlock unlimited conversions.</p>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<footer>
  <div class="footer-container">
      <div class="footer-content">
          
          <!-- About Section -->
          <div class="footer-section">
              <h3>About Online OCR</h3>
              <p>Online OCR is a powerful text extraction tool that allows users to convert images into editable text with high accuracy.</p>
          </div>

<!-- Quick Links -->
<div class="footer-section">
  <h3>Quick Links</h3>
  <ul>
      <li><a href="/about">About</a></li>
      <li><a href="/features">Key Features</a></li>
      <li><a href="/pricing">Pricing</a></li>
      <li><a href="/api">API</a></li>
      <li><a href="/faq">FAQ</a></li>
  </ul>
</div>

<!-- Legal & Contact -->
<div class="footer-section">
  <h3>Legal</h3>
  <ul>
      <li><a href="/term">Terms of Service</a></li>
      <li><a href="/privacy">Privacy Policy</a></li>
      <li><a href="/contact">Contact Us</a></li>
  </ul>
</div>



            <!-- Social & Contact -->
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <div class="social-links">
                    <a href="https://www.facebook.com/share/1HHfKfZFrg/" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="https://www.instagram.com/short_talks001/" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.linkedin.com/in/san-ansari-b0b2a4241?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                </div>
                <p>Email: <a href="mailto:creativeshanansari@gmail.com">creativeshanansari@gmail.com</a></p>
                <!-- <p>Phone: <a href="tel:+1234567890">+1 (234) 567-890</a></p> -->
            </div>
      </div>

      <!-- Back to Top -->
      <div class="footer-bottom">
          <p>&copy; 2025 Online OCR. All rights reserved.</p>
          <a href="#top" class="back-to-top"><i class="fas fa-arrow-up"></i> Back to Top</a>
      </div>
  </div>
</footer>

  <!-- Scripts -->
  <script>
async function downloadWordFile() {
    let button = document.getElementById("download-word-btn");
    let icon = button.querySelector("i");
    let text = button.querySelector("span");

    let fileInput = document.getElementById("file-input"); // ✅ Use existing file input
    let selectedLanguage = document.getElementById("selected-option").getAttribute("data-value"); // ✅ Get selected language

    // Get the uploaded file
    let file = fileInput.files[0];

    if (!file) {
        alert("❌ Please upload an image or PDF first!");
        return;
    }

    // ✅ Show loading state
    text.innerText = "Please Wait Downloading...";
    button.disabled = true;
    icon.classList.remove("fa-download");  // Remove download icon
    icon.classList.add("fa-spinner", "fa-spin"); // ✅ Add spinning effect

    try {
        let formData = new FormData();
        formData.append("file", file);
        formData.append("language", selectedLanguage);

        let response = await fetch("https://san786s-ocr-backend.hf.space/ocr-to-word", {
            method: 'POST',
            body: formData
        });

        if (!response.ok) throw new Error("Failed to download the file.");

        // Convert response to a downloadable file
        let blob = await response.blob();
        let url = window.URL.createObjectURL(blob);

        // Create a hidden download link & trigger download
        let a = document.createElement("a");
        a.href = url;
        a.download = "extracted_text.docx";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

    } catch (error) {
        console.error(error);
        alert("❌ Failed to download the file. Please try again.");
    }

    // ✅ Restore button state after download starts
    text.innerText = "Download Word";
    icon.classList.remove("fa-spinner", "fa-spin");  // ✅ Remove spinning effect
    icon.classList.add("fa-download");  // ✅ Restore download icon
    button.disabled = false;
}

    document.addEventListener("DOMContentLoaded", function () {
  const modal = document.getElementById("modal-menu");
  const menuBtn = document.getElementById("menu-btn");
  const closeBtn = document.querySelector(".close-btn");

  // Open Modal
  menuBtn.addEventListener("click", () => {
    modal.style.display = "block";
  });

  // Close Modal
  closeBtn.addEventListener("click", () => {
    modal.style.display = "none";
  });

  // Close when clicking outside modal
  window.addEventListener("click", (e) => {
    if (e.target === modal) {
      modal.style.display = "none";
    }
  });
});

// console.log(document.body.scrollWidth, window.innerWidth);
document.addEventListener("DOMContentLoaded", function () {
    const languageSelectContainer = document.querySelector(".language-select"); // Full container div
    const mobileMenuContainer = document.querySelector(".mobile-menu-container"); // Mobile container
    const navRight = document.querySelector(".nav-right"); // Desktop container
    const languageSelect = document.getElementById("ui-language-select");

// ✅ Function to Translate Content Based on Selected Language
function translateContent(language) {
    const translations = {
        "en": {
            "home": "Home",
            "imageToWord": "IMAGE TO WORD",
            "imageToExcel": "IMAGE TO EXCEL",
            "pdfToImage": "PDF TO IMAGE",
            "darkMode": "🌙 Dark Mode"
        },
        "hi": {
            "home": "होम",
            "imageToWord": "छवि से शब्द",
            "imageToExcel": "छवि से एक्सेल",
            "pdfToImage": "पीडीएफ से छवि",
            "darkMode": "🌙 डार्क मोड"
        },
        "es": {
            "home": "Inicio",
            "imageToWord": "IMAGEN A WORD",
            "imageToExcel": "IMAGEN A EXCEL",
            "pdfToImage": "PDF A IMAGEN",
            "darkMode": "🌙 Modo Oscuro"
        },
        "fr": {
            "home": "Accueil",
            "imageToWord": "IMAGE VERS WORD",
            "imageToExcel": "IMAGE VERS EXCEL",
            "pdfToImage": "PDF VERS IMAGE",
            "darkMode": "🌙 Mode Sombre"
        },
        "de": {
            "home": "Startseite",
            "imageToWord": "BILD ZU WORD",
            "imageToExcel": "BILD ZU EXCEL",
            "pdfToImage": "PDF ZU BILD",
            "darkMode": "🌙 Dunkler Modus"
        }
    };

    // ✅ Translate All Elements with "data-key"
    document.querySelectorAll(".translate").forEach(element => {
        const key = element.getAttribute("data-key");
        if (translations[language] && translations[language][key]) {
            element.textContent = translations[language][key];
        }
    });

    // ✅ Translate Dark Mode Buttons
    const darkModeButtons = document.querySelectorAll("#theme-toggle, #modal-theme-toggle");
    darkModeButtons.forEach(button => {
        if (translations[language] && translations[language]["darkMode"]) {
            button.textContent = translations[language]["darkMode"];
        }
    });

    // ✅ Save Language Preference
    localStorage.setItem("selectedLanguage", language);
}


    // ✅ Set Saved Language (If Exists) or Default to English
    const savedLanguage = localStorage.getItem("selectedLanguage") || "en";
    languageSelect.value = savedLanguage;
    translateContent(savedLanguage);

    // ✅ Event Listener for Language Change
    languageSelect.addEventListener("change", function () {
        translateContent(languageSelect.value);
    });

    // ✅ Function to Move Language Selector Based on Screen Size
    function moveLanguageSelector() {
        if (window.innerWidth <= 955) {
            // Move to Mobile Container (if not already there)
            if (!mobileMenuContainer.contains(languageSelectContainer)) {
                mobileMenuContainer.insertBefore(languageSelectContainer, mobileMenuContainer.firstChild);
            }
        } else {
            // Move to Desktop Container (if not already there)
            if (!navRight.contains(languageSelectContainer)) {
                navRight.appendChild(languageSelectContainer);
            }
        }
    }

    moveLanguageSelector(); // Initial call
    window.addEventListener("resize", moveLanguageSelector); // On window resize
});

</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.0.2/tesseract.min.js"></script>

  <script src="/templates/static/js/script.js"></script>
</body>
</html>
